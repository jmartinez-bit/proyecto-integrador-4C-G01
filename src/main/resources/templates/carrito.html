<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="fragments/home_layout :: head"></head>
<body>
	<nav th:replace="fragments/home_layout :: nav"></nav>
	
	<main>
		<div class="container mt-5">
		<div>
			<h3>Carrito de compras: </h3><br>
		</div>
		<div class="row m-1">
			<div class="col-sm-8">
				<th:block th:each="item, status : ${carritoItems}">
				<div class="row border rounded" th:with="producto = ${item.productoId}"
						th:id="'row' + ${status.count}">
					<div class="col-1">
						<div>[[${status.count}]]</div>
						<div>
							<a class="fas fa-trash icon-dark link-remove" 
								th:rowNumber="${status.count}"
								th:href="@{'/carrito/remove/' + ${producto.id}}">
							</a>
						</div>
					</div>
					<div class="col-3">
						<img th:if="${producto.foto != null && #strings.length(producto.foto) > 0}" th:src="@{'/uploads/' + ${producto.foto}}" class="img-fluid" alt="">
					</div>
					<div class="col-6">
						<div>
							<a th:href="@{/productos/} + ${producto.id}" th:title="${producto.nombre}" target="_blank">
								<b>[[${producto.nombre}]]</b>
							</a>
						</div>
						<div th:replace="fragments/cantidad_control :: cantidad_control(${item.cantidad}, ${item.productoId.id})">Cantidad</div>
						<div>
							<span>x&nbsp;</span>
							<span>S/. [[${producto.precioVenta}]]</span>
						</div>
						<div>
							<span>=&nbsp;</span><span class="h4">S/. </span>
							<span th:id="'subtotal' + ${producto.id}"
							 class="h4 productoSubtotal">[[${item.subtotal}]]</span>
						</div>
					</div>
				</div>
				<div class="row m-1">&nbsp;</div>
				</th:block>
			</div>
			
			<div class="col-sm-4" th:unless="${#lists.isEmpty(carritoItems)}">
				<div>
					<span class="h3">Total Estimado</span>
				</div>
				<div class="mt-2">
					<span class="h2" id="totalAmount"></span>
				</div>
				<div class="mt-2">
					<button class="btn btn-success mt-2 w-100 p-3">Realizar Pago</button>
				</div>
				<div>
					<button class="btn btn-secondary mt-2 w-100 p-3">Seguir comprando</button>
				</div>
			</div>
		</div>
		
		<div th:if="${#lists.isEmpty(carritoItems)}">
			<h3>Tu carrito esta vacio, puedes seguir comprando</h3>
		</div>
		</div>
	</main>
	
	<div th:replace="fragments/home_layout :: standard_modal">Standard Modal Dialog</div>
	<div th:replace="fragments/home_layout :: overlay"></div>
	<div th:replace="fragments/home_layout :: btn-cerrar"></div>
	
	<script type="text/javascript">
		contextPath = "[[@{/}]]";
		var crsfHeaderName = "[[${_csrf.headerName}]]";
		var csrfValue = "[[${_csrf.token}]]";
	</script>
	<div th:replace="fragments/home_layout :: scripts"></div>
	<script th:src="@{/js/carrito.js}"></script>
</body>
</html>